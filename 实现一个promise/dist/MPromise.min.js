!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.MPromise=t():e.MPromise=t()}(this,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var r=function(){function e(e){this.value="",this.status="pending",this.resolveValue="",this.rejectValue="",this.resolveArray=[],this.rejectArray=[],this.InResolve=this.InResolve.bind(this),this.InReject=this.InReject.bind(this),this.then=this.then.bind(this);try{e(this.InResolve,this.InReject)}catch(e){this.InReject(e)}}return e.prototype.InResolve=function(e){var t=this;"pending"==this.status&&(this.status="resolved",this.resolveValue=e,this.resolveArray.forEach(function(e){return e(t.resolveValue)}))},e.prototype.InReject=function(e){var t=this;"pending"==this.status&&(this.status="reject",this.rejectValue=e,this.rejectArray.forEach(function(e){return e(t.rejectValue)}))},e.prototype.resolvePromise=function(e,t,n,r){var o,i=this;if(e===t)return r(new TypeError("禁止返回当前Promise实例，循环引用错误"));if(null===t||"object"!=typeof t&&"function"!=typeof t)n(t);else try{var u=t.then;"function"==typeof u?u.call(t,function(t){o||(o=!0,i.resolvePromise(e,t,n,r))},function(e){o||(o=!0,r(e))}):n(t)}catch(e){if(o)return;o=!0,r(e)}},e.prototype.then=function(t,n){var r,o=this;switch(t="function"==typeof t?t:function(e){return e},n="function"==typeof n?n:function(e){throw e},this.status){case"pending":r=new e(function(e,i){o.resolveArray.push(function(){setTimeout(function(){try{var n=t(o.resolveValue);o.resolvePromise(r,n,e,i)}catch(e){i(e)}})}),o.rejectArray.push(function(){setTimeout(function(){try{var t=n(o.rejectValue);o.resolvePromise(r,t,e,i)}catch(e){i(e)}})})});break;case"resolved":r=new e(function(e,n){setTimeout(function(){try{var i=t(o.resolveValue);o.resolvePromise(r,i,e,n)}catch(e){n(e)}})});break;case"reject":r=new e(function(e,t){setTimeout(function(){try{var i=n(o.rejectValue);o.resolvePromise(r,i,e,t)}catch(e){t(e)}})})}return r},e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(t){return this.then(function(n){return e.resolve(t()).then(function(){return n})},function(n){return e.resolve(t()).then(function(){throw n})})},e.all=function(t){var n=[],r=0;return new e(function(o,i){for(var u=function(u){t[u]instanceof e||(t[u]=e.resolve(t[u])),t[u].then(function(e){n[u]=e,++r==t.length&&o(n)},function(e){i(e)})},c=0;c<t.length;c++)u(c)})},e.race=function(t){return new e(function(n,r){for(var o=0;o<t.length;o++)t[o]instanceof e||(t[o]=e.resolve(t[o])),t[o].then(function(e){n(e)},function(e){r(e)})})},e.resolve=function(t){return new e(function(e,n){e(t)})},e.reject=function(t){return new e(function(e,n){n(t)})},e.deferred=function(){var t={};return t.promise=new e(function(e,n){t.resolve=e,t.reject=n}),t},e}();t.default=r}]).default});